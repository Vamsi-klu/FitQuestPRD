<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitQuest: Interactive Product Requirements</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral with Vibrant Accents -->
    <!-- Application Structure Plan: A single-page application with a fixed sidebar navigation. This structure was chosen to break down the dense product requirements document into logical, thematic sections that are easily accessible. Users can jump to any category (e.g., UI/UX, Gamification) without scrolling, making the information highly scannable and digestible. This non-linear approach enhances usability by allowing users to explore the requirements based on their interests, rather than being forced through a linear document. -->
    <!-- Visualization & Content Choices: The application uses cards, icons, and two charts to visually represent key concepts from the report. 1) Core Features: A bar chart visualizes the variety of supported activity types (Goal: Organize) to provide a quick overview before the detailed text. 2) Gamification: A doughnut chart breaks down the motivational strategies (Goal: Inform/Organize) into its core components. These visualizations serve to break up text, increase engagement, and make the abstract concepts more concrete. All other information is presented in structured cards and lists for clarity. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f4;
            color: #3d3d3d;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .nav-link {
            transition: all 0.2s ease-in-out;
        }
        .nav-link.active {
            background-color: #ff8c42;
            color: #ffffff;
            font-weight: 600;
        }
        .nav-link:not(.active):hover {
            background-color: #eaddd7;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        /* Animated dots loader */
        .loader {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            width: 100%;
            margin: 8px 0;
        }
        .loader span {
            width: 8px;
            height: 8px;
            background-color: #ff8c42;
            border-radius: 9999px;
            opacity: 0.4;
            animation: pulse 1.2s ease-in-out infinite;
        }
        .loader span:nth-child(2) { animation-delay: 0.15s; }
        .loader span:nth-child(3) { animation-delay: 0.3s; }
        @keyframes pulse {
            0%, 100% { transform: translateY(0); opacity: 0.4; }
            50% { transform: translateY(-4px); opacity: 1; }
        }
        .status-step { display: flex; align-items: center; gap: 8px; }
        .status-dot { width: 8px; height: 8px; border-radius: 9999px; background: #e5e7eb; }
        .status-dot.active { background: #ff8c42; }
        .status-dot.done { background: #10b981; }
        .typewriter { white-space: pre-wrap; }
    </style>
</head>
<body class="antialiased">

    <div class="flex flex-col md:flex-row min-h-screen">
        <!-- Sidebar Navigation -->
        <aside class="w-full md:w-64 bg-[#f0e6e0] p-4 md:p-6 flex-shrink-0">
            <h1 class="text-2xl font-bold text-[#ff8c42] mb-8">FitQuest PRD</h1>
            <nav class="space-y-2">
                <a href="#" id="nav-ui" class="nav-link block py-2.5 px-4 rounded-lg text-gray-700 font-medium active">UI & UX</a>
                <a href="#" id="nav-features" class="nav-link block py-2.5 px-4 rounded-lg text-gray-700 font-medium">Core Features</a>
                <a href="#" id="nav-gamification" class="nav-link block py-2.5 px-4 rounded-lg text-gray-700 font-medium">Gamification</a>
                <a href="#" id="nav-ai" class="nav-link block py-2.5 px-4 rounded-lg text-gray-700 font-medium">âœ¨ AI Features</a>
                <a href="#" id="nav-integration" class="nav-link block py-2.5 px-4 rounded-lg text-gray-700 font-medium">Integration & Security</a>
                <a href="#" id="nav-platform" class="nav-link block py-2.5 px-4 rounded-lg text-gray-700 font-medium">Platform & Performance</a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-6 md:p-10 overflow-y-auto">
            
            <!-- UI & UX Section -->
            <section id="content-ui" class="content-section active">
                <h2 class="text-3xl font-bold mb-4 text-gray-800">User Interface & Experience</h2>
                <p class="text-gray-600 mb-8 max-w-3xl">This section outlines the design philosophy and user experience goals for FitQuest. The aim is to create an app that is not only functional but also delightful and motivating to use, ensuring users feel supported on their fitness journey.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">Clean & Vibrant</h3>
                        <p class="text-gray-600 text-sm">A modern, uncluttered UI with an energetic color palette to evoke positivity and motivation.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">Intuitive Navigation</h3>
                        <p class="text-gray-600 text-sm">A persistent bottom navigation bar for one-tap access to all major app sections.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">Engaging Visuals</h3>
                        <p class="text-gray-600 text-sm">Data presented in appealing charts and infographics, avoiding dense tables of numbers.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">Delightful Interactions</h3>
                        <p class="text-gray-600 text-sm">Subtle animations and haptic feedback to make the app feel responsive and engaging.</p>
                    </div>
                </div>

                <div class="mt-10 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Onboarding</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Quick, skippable tour of key features.</li>
                            <li>Guided setup to connect wearables and set first goal.</li>
                            <li>Invitation to a beginner-friendly challenge.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Accessibility</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Adherence to WCAG 2.1 AA standards.</li>
                            <li>High-contrast mode and dynamic font sizes.</li>
                            <li>Full screen reader compatibility for iOS and Android.</li>
                        </ul>
                    </div>
                </div>

                <!-- AI Enhance: UI & UX -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mt-8 js-ai-enhance" data-section="ui">
                    <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">âœ¨ AI Enhance this section</h3>
                    <p class="text-gray-600 text-sm mb-3">Describe what you want to enhance for UI & UX.</p>
                    <div class="flex gap-2 items-start">
                        <input type="text" class="flex-1 p-2 rounded border border-gray-300 text-sm" placeholder="e.g., Improve readability and reduce motion for accessibility">
                        <button class="bg-[#ff8c42] text-white font-bold py-2 px-4 rounded-lg hover:bg-opacity-90 transition-colors" data-enhance-btn>Enhance</button>
                    </div>
                    <div class="ai-output mt-4 text-sm"></div>
                    <div class="ai-save-status mt-2 text-xs text-gray-500"></div>
                </div>
            </section>

            <!-- Core Features Section -->
            <section id="content-features" class="content-section">
                <h2 class="text-3xl font-bold mb-4 text-gray-800">Core Features: Activity & Metric Tracking</h2>
                <p class="text-gray-600 mb-8 max-w-3xl">FitQuest's core functionality revolves around comprehensive and accurate activity tracking. This section details the supported activities, the metrics we'll track, and the in-app experience during a workout.</p>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-8">
                    <h3 class="font-semibold text-lg mb-4 text-center">Supported Activity Categories</h3>
                    <div class="chart-container">
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Tracking & Metrics</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>GPS tracking for outdoor routes, distance, and pace.</li>
                            <li>Sensor-based data for steps, heart rate, and calories.</li>
                            <li>Detailed logging for strength training (sets, reps, weight).</li>
                            <li>Manual entry for any missed activities.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Live Activity View</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Large, easy-to-read display of key metrics.</li>
                            <li>Simple controls to pause, resume, and finish.</li>
                            <li>Audio cues for distance milestones.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Data Analytics & Insights</h3>
                         <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>At-a-glance dashboard with daily/weekly summaries.</li>
                            <li>Progress reports highlighting trends and personal bests.</li>
                            <li>Personalized insights based on user data analysis.</li>
                             <li>âœ¨ Enhanced with generative AI for deeper insights.</li>
                        </ul>
                    </div>
                </div>

                <!-- AI Enhance: Core Features -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mt-8 js-ai-enhance" data-section="features">
                    <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">âœ¨ AI Enhance this section</h3>
                    <p class="text-gray-600 text-sm mb-3">Describe what to expand or refine in features and metrics.</p>
                    <div class="flex gap-2 items-start">
                        <input type="text" class="flex-1 p-2 rounded border border-gray-300 text-sm" placeholder="e.g., Add strength metrics and form cues">
                        <button class="bg-[#ff8c42] text-white font-bold py-2 px-4 rounded-lg hover:bg-opacity-90 transition-colors" data-enhance-btn>Enhance</button>
                    </div>
                    <div class="ai-output mt-4 text-sm"></div>
                    <div class="ai-save-status mt-2 text-xs text-gray-500"></div>
                </div>
            </section>

            <!-- Gamification Section -->
            <section id="content-gamification" class="content-section">
                <h2 class="text-3xl font-bold mb-4 text-gray-800">Gamification & Motivation</h2>
                <p class="text-gray-600 mb-8 max-w-3xl">To keep users engaged and motivated, FitQuest will incorporate several gamification elements. The goal is to make fitness fun and rewarding, encouraging long-term consistency through positive reinforcement.</p>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-8">
                    <h3 class="font-semibold text-lg mb-4 text-center">Pillars of Motivation</h3>
                     <div class="chart-container">
                        <canvas id="gamificationChart"></canvas>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Rewards System</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Earn XP to level up with every workout.</li>
                            <li>Unlock visually appealing badges for milestones.</li>
                            <li>Track activity streaks to build consistency.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Challenges</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Set personal goals to work towards.</li>
                            <li>Invite friends to private group competitions.</li>
                            <li>Participate in large, themed community events.</li>
                            <li>âœ¨ Create your own challenges with generative AI.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Leaderboards</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Weekly rankings for steps, distance, and time.</li>
                            <li>Filterable views for Friends, Country, and Global.</li>
                        </ul>
                    </div>
                </div>

                <!-- AI Enhance: Gamification -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mt-8 js-ai-enhance" data-section="gamification">
                    <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">âœ¨ AI Enhance this section</h3>
                    <p class="text-gray-600 text-sm mb-3">Describe new challenges, rewards, or progression ideas.</p>
                    <div class="flex gap-2 items-start">
                        <input type="text" class="flex-1 p-2 rounded border border-gray-300 text-sm" placeholder="e.g., Create seasonal challenges and co-op goals">
                        <button class="bg-[#ff8c42] text-white font-bold py-2 px-4 rounded-lg hover:bg-opacity-90 transition-colors" data-enhance-btn>Enhance</button>
                    </div>
                    <div class="ai-output mt-4 text-sm"></div>
                    <div class="ai-save-status mt-2 text-xs text-gray-500"></div>
                </div>
            </section>
            
            <!-- AI Features Section -->
            <section id="content-ai" class="content-section">
                <h2 class="text-3xl font-bold mb-4 text-gray-800">âœ¨ AI Features powered by Gemini</h2>
                <p class="text-gray-600 mb-8 max-w-3xl">To provide a truly personalized and dynamic experience, FitQuest will leverage the Gemini API. These features transform user data into motivational coaching and create limitless, fun ways to stay active.</p>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-xl mb-3 text-[#ff8c42]">Personalized AI Insights</h3>
                        <p class="text-gray-600 mb-4 text-sm">Go beyond basic stats. The Gemini API will analyze workout history, spot trends, and provide narrative, motivational feedback that feels like a personal coach.</p>
                        <div class="bg-gray-100 p-4 rounded-lg">
                            <p class="text-sm font-medium text-gray-800 mb-2">Example Insight:</p>
                            <p class="text-gray-600 text-sm italic">"Great job on your consistency this week, Alex! I noticed your average cycling speed has increased by 5% over the last month. It looks like those weekend long rides are really building your endurance. Keep it up!"</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-xl mb-3 text-[#ff8c42]">Dynamic Challenge Generator</h3>
                        <p class="text-gray-600 mb-4 text-sm">Never get bored again. Users can describe a themed challenge, and the Gemini API will generate a custom plan with unique goals, turning fitness into an adventure.</p>
                        <div class="bg-gray-100 p-4 rounded-lg">
                            <p class="text-sm font-medium text-gray-800 mb-2">User Prompt Example:</p>
                            <input id="challenge-prompt-input" type="text" value="A 1-week 'Climb Mount Everest' challenge using stairs" class="w-full p-2 rounded border border-gray-300 text-sm">
                            <button id="generate-challenge-btn" class="w-full bg-[#ff8c42] text-white font-bold py-2 px-4 rounded-lg mt-2 hover:bg-opacity-90 transition-colors">âœ¨ Generate Challenge</button>
                            <div id="challenge-output" class="mt-4 text-sm"></div>
                        </div>
                    </div>
                </div>

                <!-- AI Enhance: AI Section (generic) -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mt-8 js-ai-enhance" data-section="ai">
                    <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">âœ¨ AI Enhance this section</h3>
                    <p class="text-gray-600 text-sm mb-3">Describe additional AI capabilities or prompts to support.</p>
                    <div class="flex gap-2 items-start">
                        <input type="text" class="flex-1 p-2 rounded border border-gray-300 text-sm" placeholder="e.g., Add nutrition insights and habit coaching prompts">
                        <button class="bg-[#ff8c42] text-white font-bold py-2 px-4 rounded-lg hover:bg-opacity-90 transition-colors" data-enhance-btn>Enhance</button>
                    </div>
                    <div class="ai-output mt-4 text-sm"></div>
                    <div class="ai-save-status mt-2 text-xs text-gray-500"></div>
                </div>
            </section>

            <!-- Integration & Security Section -->
            <section id="content-integration" class="content-section">
                <h2 class="text-3xl font-bold mb-4 text-gray-800">Integration & Security</h2>
                <p class="text-gray-600 mb-8 max-w-3xl">Seamless data synchronization and robust security are foundational to user trust. This section covers how FitQuest will connect with other platforms and how we will protect user data and privacy.</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Data Synchronization</h3>
                        <p class="text-gray-600 mb-4 text-sm">Sync workout data, heart rate, and more with major health platforms.</p>
                        <div class="flex space-x-4">
                            <span class="bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full">Apple Health</span>
                            <span class="bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full">Google Fit</span>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Wearable Integration</h3>
                        <p class="text-gray-600 mb-4 text-sm">Directly connect and automatically sync with popular fitness trackers.</p>
                        <div class="flex flex-wrap gap-2">
                             <span class="bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full">Apple Watch</span>
                             <span class="bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full">Garmin</span>
                             <span class="bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full">Fitbit</span>
                             <span class="bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full">WHOOP</span>
                        </div>
                    </div>
                     <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Data Protection & Security</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>End-to-end encryption (TLS 1.2+ in transit, AES-256 at rest).</li>
                            <li>Compliance with GDPR, CCPA, and HIPAA-ready standards.</li>
                            <li>Secure authentication via OAuth 2.0 with social sign-on.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Privacy Controls</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Granular profile privacy settings (Public, Friends, Private).</li>
                            <li>Clear and accessible data sharing preferences.</li>
                            <li>Easy options to hide or obscure workout map location data.</li>
                        </ul>
                    </div>
                </div>

                <!-- AI Enhance: Integration & Security -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mt-8 js-ai-enhance" data-section="integration">
                    <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">âœ¨ AI Enhance this section</h3>
                    <p class="text-gray-600 text-sm mb-3">Describe integrations or security practices to expand.</p>
                    <div class="flex gap-2 items-start">
                        <input type="text" class="flex-1 p-2 rounded border border-gray-300 text-sm" placeholder="e.g., Add OAuth scopes and data retention policy">
                        <button class="bg-[#ff8c42] text-white font-bold py-2 px-4 rounded-lg hover:bg-opacity-90 transition-colors" data-enhance-btn>Enhance</button>
                    </div>
                    <div class="ai-output mt-4 text-sm"></div>
                    <div class="ai-save-status mt-2 text-xs text-gray-500"></div>
                </div>
            </section>

            <!-- Platform & Performance Section -->
            <section id="content-platform" class="content-section">
                <h2 class="text-3xl font-bold mb-4 text-gray-800">Platform & Performance</h2>
                <p class="text-gray-600 mb-8 max-w-3xl">FitQuest will be a high-performing, native application available on both iOS and Android. This section details compatibility requirements, backend architecture, and key performance benchmarks.</p>
                
                <h3 class="font-semibold text-lg mb-4 text-center">Key Performance Benchmarks</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 text-center">
                        <p class="text-3xl font-bold text-[#ff8c42]">&lt; 2s</p>
                        <p class="text-gray-600 mt-1">App Launch Time</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 text-center">
                        <p class="text-3xl font-bold text-[#ff8c42]">60fps</p>
                        <p class="text-gray-600 mt-1">UI Responsiveness</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 text-center">
                        <p class="text-3xl font-bold text-[#ff8c42]">&lt; 500ms</p>
                        <p class="text-gray-600 mt-1">API Response (p95)</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Platform Compatibility</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Native development for iOS and Android for best performance.</li>
                            <li>iOS: Support for the latest major version and one prior.</li>
                            <li>Android: Support for the latest three major versions.</li>
                            <li>Adherence to platform-specific design guidelines.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">Scalable Architecture</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Backend built on a serverless cloud infrastructure.</li>
                            <li>Scalable database to handle user growth.</li>
                            <li>Well-documented RESTful or GraphQL API.</li>
                        </ul>
                    </div>
                </div>

                <!-- AI Enhance: Platform & Performance -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mt-8 js-ai-enhance" data-section="platform">
                    <h3 class="font-semibold text-lg mb-2 text-[#ff8c42]">âœ¨ AI Enhance this section</h3>
                    <p class="text-gray-600 text-sm mb-3">Describe performance, scalability, or reliability goals.</p>
                    <div class="flex gap-2 items-start">
                        <input type="text" class="flex-1 p-2 rounded border border-gray-300 text-sm" placeholder="e.g., Optimize cold start and add p95 budgets">
                        <button class="bg-[#ff8c42] text-white font-bold py-2 px-4 rounded-lg hover:bg-opacity-90 transition-colors" data-enhance-btn>Enhance</button>
                    </div>
                    <div class="ai-output mt-4 text-sm"></div>
                    <div class="ai-save-status mt-2 text-xs text-gray-500"></div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            // Config: set backendURL to your API to enable real submits
            const CONFIG = {
                backendURL: null, // e.g., 'https://api.example.com'
                endpointPath: '/api/ai/enhance',
                requestTimeoutMs: 4000,
                localQueueKey: 'aiEnhancementQueue'
            };

            const navigateTo = (id) => {
                navLinks.forEach(link => link.classList.remove('active'));
                contentSections.forEach(section => section.classList.remove('active'));

                const targetLink = document.querySelector(`#nav-${id}`);
                const targetSection = document.querySelector(`#content-${id}`);

                if (targetLink) targetLink.classList.add('active');
                if (targetSection) targetSection.classList.add('active');
            };

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const id = link.id.split('-')[1];
                    navigateTo(id);
                });
            });

            // --- Universal AI Enhance logic for all sections ---
            const typewriter = (el, text, speed = 12) => new Promise(resolve => {
                let i = 0;
                const tick = () => {
                    el.textContent += text.charAt(i);
                    i++;
                    if (i < text.length) setTimeout(tick, speed); else resolve();
                };
                tick();
            });

            const makeId = () => Math.random().toString(36).slice(2) + Date.now().toString(36);
            const getQueue = () => {
                try { return JSON.parse(localStorage.getItem(CONFIG.localQueueKey) || '[]'); } catch { return []; }
            };
            const saveQueue = (q) => localStorage.setItem(CONFIG.localQueueKey, JSON.stringify(q));

            const safeFetchWithTimeout = async (url, opts = {}, timeoutMs = CONFIG.requestTimeoutMs) => {
                if (!url) throw new Error('No URL provided');
                const controller = new AbortController();
                const t = setTimeout(() => controller.abort(), timeoutMs);
                try {
                    const res = await fetch(url, { ...opts, signal: controller.signal });
                    clearTimeout(t);
                    return res;
                } catch (e) {
                    clearTimeout(t);
                    throw e;
                }
            };

            const persistEnhancement = async (payload, statusEl) => {
                const urlBase = CONFIG.backendURL || '';
                const url = urlBase + CONFIG.endpointPath;
                statusEl.textContent = 'Saving to backendâ€¦';
                try {
                    const res = await safeFetchWithTimeout(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!res.ok) throw new Error('Non-OK response');
                    statusEl.textContent = 'Saved to backend âœ”ï¸';
                    statusEl.classList.remove('text-gray-500');
                    statusEl.classList.add('text-green-600');
                    return { ok: true };
                } catch (e) {
                    // Fallback: navigator.sendBeacon
                    try {
                        const blob = new Blob([JSON.stringify(payload)], { type: 'application/json' });
                        const ok = navigator.sendBeacon ? navigator.sendBeacon(url, blob) : false;
                        if (ok) {
                            statusEl.textContent = 'Saved via beacon âœ”ï¸';
                            statusEl.classList.remove('text-gray-500');
                            statusEl.classList.add('text-green-600');
                            return { ok: true };
                        }
                    } catch {}
                    // Final fallback: queue locally
                    const queued = getQueue();
                    queued.push(payload);
                    saveQueue(queued);
                    statusEl.textContent = 'Backend unreachable. Queued locally â³';
                    statusEl.classList.remove('text-gray-500');
                    statusEl.classList.add('text-yellow-600');
                    return { ok: false, queued: true };
                }
            };

            const flushQueue = async () => {
                if (!CONFIG.backendURL) return; // Only try when a backend is configured
                let q = getQueue();
                if (!q.length) return;
                const next = [];
                for (const item of q) {
                    try {
                        const res = await safeFetchWithTimeout(CONFIG.backendURL + CONFIG.endpointPath, {
                            method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(item)
                        });
                        if (!res.ok) next.push(item);
                    } catch {
                        next.push(item);
                    }
                }
                saveQueue(next);
            };

            // Periodically try to flush if a backend is set
            setTimeout(flushQueue, 2000);
            setInterval(flushQueue, 10000);

            const initialStatusMarkup = () => `
                <div class="bg-white border border-gray-200 rounded-lg p-4">
                    <div class="status-step mb-2"><span class="status-dot active" aria-hidden="true"></span><span class="text-sm text-gray-700">Parsing promptâ€¦</span></div>
                    <div class="status-step mb-2"><span class="status-dot" aria-hidden="true"></span><span class="text-sm text-gray-700">Searching referencesâ€¦</span></div>
                    <div class="status-step mb-4"><span class="status-dot" aria-hidden="true"></span><span class="text-sm text-gray-700">Composing planâ€¦</span></div>
                    <div class="loader" role="status" aria-label="Searching"><span></span><span></span><span></span></div>
                </div>`;

            const sectionTemplates = {
                ui: (p) => ({ title: 'UI/UX Enhancements', bullets: [
                    'Improve color contrast and spacing',
                    'Reduce motion with prefers-reduced-motion',
                    'Clarify labels and empty states',
                    'Keyboard navigation and focus outlines',
                    `Goal: ${p}`
                ]}),
                features: (p) => ({ title: 'Feature & Metrics Expansion', bullets: [
                    'Add strength form cues (tempo, ROM)',
                    'Expand GPS metrics (elevation, splits)',
                    'Smart defaults for activity types',
                    'Auto-tagging and anomaly detection',
                    `Goal: ${p}`
                ]}),
                gamification: (p) => ({ title: 'Gamification Ideas', bullets: [
                    'Seasonal quests and streak boosts',
                    'Co-op goals with shared milestones',
                    'Badge sets with tiered rarity',
                    'Dynamic difficulty and anti-burnout',
                    `Theme: ${p}`
                ]}),
                integration: (p) => ({ title: 'Integration & Security Plan', bullets: [
                    'OAuth scopes and token rotation',
                    'PII minimization and data lifecycle',
                    'Webhooks with signed HMAC and retries',
                    'Audit logs and anomaly alerts',
                    `Policy: ${p}`
                ]}),
                platform: (p) => ({ title: 'Platform & Performance Goals', bullets: [
                    'Cold start < 1.5s, p95 API < 400ms',
                    'Jank-free UI at 60fps',
                    'Background sync and offline-first',
                    'SLOs, alerts, and budgets',
                    `Target: ${p}`
                ]}),
                ai: (p) => ({ title: 'AI Capabilities Expansion', bullets: [
                    'Insight narratives with personal tone',
                    'Challenge generator with safety guardrails',
                    'On-device hints with privacy-preserving signals',
                    'Human-in-the-loop feedback loops',
                    `Focus: ${p}`
                ]}),
            };

            const runEnhancement = async (sectionKey, prompt, outputEl, saveEl, buttonEl) => {
                buttonEl.disabled = true;
                outputEl.setAttribute('aria-live', 'polite');
                outputEl.innerHTML = initialStatusMarkup();
                const dots = outputEl.querySelectorAll('.status-dot');
                const advance = (i) => { if (i>0){ dots[i-1].classList.remove('active'); dots[i-1].classList.add('done'); } if (dots[i]) dots[i].classList.add('active'); };
                setTimeout(() => advance(1), 500);
                setTimeout(() => advance(2), 1000);

                setTimeout(async () => {
                    dots.forEach(d => d.classList.remove('active'));
                    dots.forEach(d => d.classList.add('done'));
                    const loader = outputEl.querySelector('.loader');
                    if (loader) loader.remove();

                    const container = document.createElement('div');
                    container.className = 'mt-3 border-l-4 border-[#ff8c42] pl-4 text-gray-700';
                    const header = document.createElement('h4');
                    header.className = 'font-bold mb-1';
                    container.appendChild(header);
                    const list = document.createElement('ul');
                    list.className = 'list-disc list-inside space-y-1';
                    container.appendChild(list);
                    outputEl.appendChild(container);

                    const template = (sectionTemplates[sectionKey] || sectionTemplates.ui)(prompt || 'Enhance this section');
                    await typewriter(header, template.title, 10);
                    for (const line of template.bullets) {
                        const li = document.createElement('li');
                        li.className = 'opacity-0 transition-opacity duration-300';
                        list.appendChild(li);
                        await new Promise(r => setTimeout(r, 110));
                        li.textContent = line;
                        li.classList.remove('opacity-0');
                    }

                    // Persist to backend (or queue)
                    const payload = {
                        id: makeId(),
                        section: sectionKey,
                        prompt,
                        output: template,
                        at: new Date().toISOString(),
                    };
                    await persistEnhancement(payload, saveEl);
                    buttonEl.disabled = false;
                }, 1600);
            };

            // Wire all AI enhance cards
            document.querySelectorAll('.js-ai-enhance').forEach(card => {
                const btn = card.querySelector('[data-enhance-btn]');
                const input = card.querySelector('input');
                const out = card.querySelector('.ai-output');
                const save = card.querySelector('.ai-save-status');
                const sectionKey = card.dataset.section;
                if (btn && input && out) {
                    btn.addEventListener('click', () => {
                        const val = (input.value || '').trim();
                        if (!val) return;
                        runEnhancement(sectionKey, val, out, save, btn);
                    });
                }
            });

            // AI Challenge Generator Logic (interactive background search + streaming output)
            const generateBtn = document.getElementById('generate-challenge-btn');
            const promptInput = document.getElementById('challenge-prompt-input');
            const challengeOutput = document.getElementById('challenge-output');

            if (generateBtn) {
                generateBtn.addEventListener('click', () => {
                    const userPrompt = promptInput.value;
                    if (!userPrompt) return;

                    // Disable and prep output region (live updates for screen readers)
                    generateBtn.disabled = true;
                    challengeOutput.setAttribute('aria-live', 'polite');
                    challengeOutput.innerHTML = `
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="status-step mb-2">
                                <span class="status-dot active" aria-hidden="true"></span>
                                <span class="text-sm text-gray-700">Parsing promptâ€¦</span>
                            </div>
                            <div class="status-step mb-2">
                                <span class="status-dot" aria-hidden="true"></span>
                                <span class="text-sm text-gray-700">Searching activities & referencesâ€¦</span>
                            </div>
                            <div class="status-step mb-4">
                                <span class="status-dot" aria-hidden="true"></span>
                                <span class="text-sm text-gray-700">Composing planâ€¦</span>
                            </div>
                            <div class="loader" role="status" aria-label="Searching">
                                <span></span><span></span><span></span>
                            </div>
                        </div>
                    `;

                    // Helper: typewriter effect
                    const typeInto = (el, text, speed = 12) => new Promise(resolve => {
                        let i = 0;
                        const tick = () => {
                            el.textContent += text.charAt(i);
                            i++;
                            if (i < text.length) {
                                setTimeout(tick, speed);
                            } else {
                                resolve();
                            }
                        };
                        tick();
                    });

                    // Simulate staged background steps updating UI
                    const steps = challengeOutput.querySelectorAll('.status-step');
                    const dots = challengeOutput.querySelectorAll('.status-dot');
                    const advanceStep = (idx) => {
                        if (idx > 0) {
                            dots[idx-1].classList.remove('active');
                            dots[idx-1].classList.add('done');
                        }
                        if (dots[idx]) dots[idx].classList.add('active');
                    };

                    setTimeout(() => advanceStep(1), 600);
                    setTimeout(() => advanceStep(2), 1200);

                    // After staged search, stream the generated content
                    setTimeout(async () => {
                        // Mark all steps done and remove loader
                        dots.forEach(d => d.classList.remove('active'));
                        dots.forEach(d => d.classList.add('done'));
                        const loader = challengeOutput.querySelector('.loader');
                        if (loader) loader.remove();

                        // Prepare streaming container
                        const container = document.createElement('div');
                        container.className = 'mt-3 border-l-4 border-[#ff8c42] pl-4 text-gray-700';
                        const title = document.createElement('p');
                        title.className = 'font-semibold text-gray-800 mb-2';
                        title.textContent = 'Your AI-Generated Challenge:';
                        const header = document.createElement('h4');
                        header.className = 'font-bold mb-1';
                        const goal = document.createElement('p');
                        goal.className = 'mb-2 typewriter';
                        const list = document.createElement('ul');
                        list.className = 'list-disc list-inside space-y-1';

                        // Insert in order
                        challengeOutput.appendChild(title);
                        challengeOutput.appendChild(container);
                        container.appendChild(header);
                        container.appendChild(goal);
                        container.appendChild(list);

                        // Choose a themed header based on prompt keywords (simple demo)
                        const prompt = userPrompt.toLowerCase();
                        let theme = 'ðŸ”ï¸ The Everest Stair Climb!';
                        if (prompt.includes('run') || prompt.includes('5k')) theme = 'ðŸƒ 7-Day 5K Builder!';
                        if (prompt.includes('yoga')) theme = 'ðŸ§˜ Flow & Stretch Week!';
                        if (prompt.includes('cycle') || prompt.includes('bike')) theme = 'ðŸš´ Hills & Endurance Ride Week!';

                        // Stream header and goal line
                        header.textContent = '';
                        await typeInto(header, theme, 10);
                        await typeInto(goal, `Goal: ${userPrompt.trim() || 'A fun themed weekly challenge.'}`, 12);

                        // Stream day-by-day items
                        const days = [
                            'Day 1: Base & Form (easy start)',
                            'Day 2: Progressive Load (light push)',
                            'Day 3: Technique Focus (skills)',
                            'Day 4: Recovery & Mobility',
                            'Day 5: Threshold Session',
                            'Day 6: Endurance / Volume',
                            'Day 7: Celebrate & Reflect',
                        ];
                        for (const d of days) {
                            const li = document.createElement('li');
                            li.className = 'opacity-0 transition-opacity duration-300';
                            list.appendChild(li);
                            await new Promise(r => setTimeout(r, 120));
                            li.textContent = d;
                            li.classList.remove('opacity-0');
                        }

                        generateBtn.disabled = false;
                    }, 1800);
                });
            }


            // Initial state
            navigateTo('ui');

            // Chart.js Implementations
            const chartColors = {
                primary: 'rgba(255, 140, 66, 0.8)',
                primaryHover: 'rgba(255, 140, 66, 1)',
                secondary: 'rgba(240, 230, 224, 0.8)',
                accent1: 'rgba(255, 204, 170, 0.8)',
                accent2: 'rgba(61, 61, 61, 0.7)',
            };
            
            Chart.defaults.font.family = "'Inter', sans-serif";
            Chart.defaults.color = '#3d3d3d';

            // Activity Chart (Bar)
            const activityCtx = document.getElementById('activityChart');
            if (activityCtx) {
                new Chart(activityCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Cardio', 'Strength', 'Classes & Sports'],
                        datasets: [{
                            label: 'Number of Example Activities',
                            data: [6, 2, 5],
                            backgroundColor: [chartColors.primary, chartColors.accent1, chartColors.secondary],
                            borderColor: [chartColors.primaryHover, chartColors.primary, chartColors.accent2],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: '#3d3d3d',
                                titleFont: { weight: 'bold' },
                                bodyFont: { size: 12 },
                                displayColors: false,
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: '#eaddd7'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            // Gamification Chart (Doughnut)
            const gamificationCtx = document.getElementById('gamificationChart');
            if (gamificationCtx) {
                new Chart(gamificationCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Rewards System', 'Challenges', 'Leaderboards'],
                        datasets: [{
                            label: 'Motivation Components',
                            data: [3, 3, 2],
                            backgroundColor: [chartColors.primary, chartColors.accent1, chartColors.accent2],
                            hoverBackgroundColor: [chartColors.primaryHover, '#ff8c42', '#3d3d3d'],
                            borderColor: '#f8f7f4',
                            borderWidth: 4,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '70%',
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    boxWidth: 12,
                                }
                            },
                            tooltip: {
                                backgroundColor: '#3d3d3d',
                                titleFont: { weight: 'bold' },
                                bodyFont: { size: 12 },
                                displayColors: true,
                            }
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>
